resource "helm_release" "cve-rag-stack" {
  
  name             = "chatbot"
  repository       = "git+ssh://git@github.com/csye7125-su24-team08/helm-cve-rag.git"
  chart            = "helm-cve-rag"
  namespace        = "chatbot-ns"
  create_namespace = true

  set {
    name  = "imagePullSecrets.dockerConfig"
    value = var.dockerCreds
  }

  set {
    name  = "db_secrets.openai_api_key"
    value = var.openai_api_key
  }

  set {
    name  = "db_secrets.flyway.password"
    value = base64encode(var.postgresPassword)
  }
}
